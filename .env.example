# MeshCore Hub - Environment Configuration
# Copy this file to .env and customize values
#
# Configuration is grouped by service. Most deployments only need:
# - Common Settings (always required)
# - MQTT Settings (always required)
# - Interface Settings (for receiver/sender services)
#
# The Collector, API, and Web services typically run as a combined "core"
# profile and share the same data directory.
#
# -----------------------------------------------------------------------------
# QUICK START: Receiver/Sender Only
# -----------------------------------------------------------------------------
# For a minimal receiver or sender setup, you only need these settings:
#
#   MQTT_HOST=your-mqtt-broker.example.com
#   MQTT_PORT=1883
#   MQTT_USERNAME=your_username
#   MQTT_PASSWORD=your_password
#   MQTT_TLS=false
#   SERIAL_PORT=/dev/ttyUSB0
#
# Serial ports are typically /dev/ttyUSB[0-9] or /dev/ttyACM[0-9] on Linux.
# -----------------------------------------------------------------------------

# =============================================================================
# COMMON SETTINGS
# =============================================================================
# These settings apply to all services

# Docker image version tag to use
# Options: latest, main, v1.0.0, etc.
IMAGE_VERSION=latest

# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Base directory for runtime data (database, etc.)
# Default: ./data (relative to docker-compose.yml location)
# Inside containers this is mapped to /data
#
# Structure:
#   ${DATA_HOME}/
#   └── collector/
#       └── meshcore.db    # SQLite database
DATA_HOME=./data

# Directory containing seed data files for import
# Default: ./seed (relative to docker-compose.yml location)
# Inside containers this is mapped to /seed
#
# Structure:
#   ${SEED_HOME}/
#   ├── node_tags.yaml    # Node tags for import
#   └── members.yaml      # Network members for import
SEED_HOME=./seed

# =============================================================================
# MQTT SETTINGS
# =============================================================================
# MQTT broker connection settings for interface, collector, and API services

# MQTT Broker host
# When using the local MQTT broker (--profile mqtt), use "mqtt"
# When using an external broker, set the hostname/IP
MQTT_HOST=mqtt

# MQTT Broker port (default: 1883, or 8883 for TLS)
MQTT_PORT=1883

# MQTT authentication (optional)
MQTT_USERNAME=
MQTT_PASSWORD=

# MQTT topic prefix for all MeshCore messages
MQTT_PREFIX=meshcore

# Enable TLS/SSL for MQTT connection
# When enabled, uses TLS with system CA certificates (e.g., for Let's Encrypt)
MQTT_TLS=false

# External port mappings for local MQTT broker (--profile mqtt only)
MQTT_EXTERNAL_PORT=1883
MQTT_WS_PORT=9001

# =============================================================================
# INTERFACE SETTINGS (Receiver/Sender)
# =============================================================================
# Settings for the MeshCore device interface services

# Serial port for receiver device
SERIAL_PORT=/dev/ttyUSB0

# Serial port for sender device (if using separate device)
SERIAL_PORT_SENDER=/dev/ttyUSB1

# Baud rate for serial communication
SERIAL_BAUD=115200

# Optional device/node name to set on startup
# This name is broadcast to the mesh network in advertisements
MESHCORE_DEVICE_NAME=

# Optional node address override (64-char hex string)
# Only set if you need to override the device's public key
NODE_ADDRESS=
NODE_ADDRESS_SENDER=

# =============================================================================
# COLLECTOR SETTINGS
# =============================================================================
# The collector subscribes to MQTT events and stores them in the database

# -------------------
# Webhook Settings
# -------------------
# Webhooks forward mesh events to external HTTP endpoints as POST requests

# Webhook for advertisement events (node discovery)
WEBHOOK_ADVERTISEMENT_URL=
WEBHOOK_ADVERTISEMENT_SECRET=

# Webhook for all message events (channel and direct messages)
WEBHOOK_MESSAGE_URL=
WEBHOOK_MESSAGE_SECRET=

# Optional: Separate URLs for channel vs direct messages
# These override WEBHOOK_MESSAGE_URL if set
# WEBHOOK_CHANNEL_MESSAGE_URL=
# WEBHOOK_CHANNEL_MESSAGE_SECRET=
# WEBHOOK_DIRECT_MESSAGE_URL=
# WEBHOOK_DIRECT_MESSAGE_SECRET=

# Webhook behavior settings
WEBHOOK_TIMEOUT=10.0
WEBHOOK_MAX_RETRIES=3
WEBHOOK_RETRY_BACKOFF=2.0

# -------------------
# Data Retention Settings
# -------------------
# Automatic cleanup of old event data (advertisements, messages, telemetry, etc.)

# Enable automatic cleanup of old event data
DATA_RETENTION_ENABLED=true

# Number of days to retain event data
# Events older than this are deleted during cleanup
DATA_RETENTION_DAYS=30

# Hours between automatic cleanup runs
# Applies to both event data and node cleanup
DATA_RETENTION_INTERVAL_HOURS=24

# -------------------
# Node Cleanup Settings
# -------------------
# Automatic removal of inactive nodes

# Enable automatic cleanup of inactive nodes
# Nodes with last_seen=NULL (never seen on network) are NOT removed
NODE_CLEANUP_ENABLED=true

# Remove nodes not seen for this many days (based on last_seen field)
NODE_CLEANUP_DAYS=7

# =============================================================================
# API SETTINGS
# =============================================================================
# REST API for querying data and sending commands

# External API port
API_PORT=8000

# API Keys for authentication
# Generate secure keys for production: openssl rand -hex 32
# Leave empty to disable authentication (not recommended for production)
API_READ_KEY=
API_ADMIN_KEY=

# =============================================================================
# WEB DASHBOARD SETTINGS
# =============================================================================
# Web interface for visualizing network status

# External web port
WEB_PORT=8080

# -------------------
# Network Information
# -------------------
# Displayed on the web dashboard homepage

# Network display name
NETWORK_NAME=MeshCore Network

# Network location
NETWORK_CITY=
NETWORK_COUNTRY=

# Radio configuration (comma-delimited)
# Format: <profile>,<frequency>,<bandwidth>,<spreading_factor>,<coding_rate>,<tx_power>
# Example: EU/UK Narrow,869.618MHz,62.5kHz,SF8,CR8,22dBm
NETWORK_RADIO_CONFIG=

# Welcome text displayed on the homepage (optional, plain text)
# If not set, a default welcome message is shown
NETWORK_WELCOME_TEXT=

# -------------------
# Contact Information
# -------------------
# Contact links displayed in the footer

NETWORK_CONTACT_EMAIL=
NETWORK_CONTACT_DISCORD=
NETWORK_CONTACT_GITHUB=
